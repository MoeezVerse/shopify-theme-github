<div class="collection-cart" style="
    z-index: 9999999;
    position: relative;">
  {% for variant in product.variants %}
    <input type="hidden" id="varaintgetid" value="{{ variant.id }}">
  {% endfor %}
  <button onclick="" type="button" name="add" id="collection-cart-{{ product.id }}" >Add To cart</button>
</div>

<script>
//   function addToCart() {
//    let addCart = document.querySelectorAll('.collection-cart button');
//     alert("ok");
// }

$(document).on('click', '#collection-cart-{{ product.id }}', function () {
    let getvarintid = $(this).parents('.collection-cart').find('#varaintgetid').val();
    alert(getvarintid);

    let formobj = {
        quantity: 1,
        id: getvarintid
    };

    $.ajax({
        type: "POST",
        url: "/cart/add.js",
        cache: false,
        data: formobj,
        dataType: "json",
        success: function (data) {
            console.log('Product added to cart:', data);

            // Fetch the updated cart
            $.ajax({
                type: "GET",
                url: "/cart.js",
                dataType: "json",
                success: function (cartData) {
                    console.log('Updated cart:', cartData);

                    // Update your cart UI dynamically here
                    $('#cart-count').text(cartData.item_count); // Example: update cart item count
                },
                error: function (xhr, ajaxOption, thrownError) {
                    console.log('Error fetching updated cart:', thrownError);
                }
            });
        },
        error: function (xhr, ajaxOption, thrownError) {
            console.log('Error adding product to cart:', thrownError);
        }
    });
});

  
</script>